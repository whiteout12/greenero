{% if not embedded %}

{% extends "base.html" %}
{% endif %}

{% block content %}

{% if embedded %}
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<script>
  $("#close").on("click", function(){
    $("#sub-menu").load("/claim");
  });

</script>

{% endif %}
<h5>{% if change %}Change{% else %}Create{% endif %} invoice {% if embedded %}<a href="#" id="close" class="btn btn-sm btn-danger"><b>&times</b></a> {% endif %}</h5>
<p></p>
<br>
<form class="form-signin" role="form" method="post" action="" id="form_inv">
  {{ form.csrf_token }}
  <p>
    {% if change %}
    changing invoice {{invoice.invoiceid}} to user {{ invoice.receiver.username }}
    {% else %}
    {{ form.receiver(placeholder="receiver") }}
    
    
    <span class="error">
      {% if form.receiver.errors %}
      {% for error in form.receiver.errors %}
      {{ error }}
      {% endfor %}
      {% endif %}
    </span>
  </p>
  {% endif %}
  <p>
    {% if change %} 
    {{ form.description(placeholder=invoice.description) }}
    {% else %}
    {{ form.description(placeholder="description") }}
    {% endif %}
    

    <span class="error">
      {% if form.description.errors %}
      {% for error in form.description.errors %}
      {{ error }}
      {% endfor %}
      {% endif %}
    </span>
  </p>

  {% if change %} 
  {{ form.amount(placeholder=invoice.amount) }}
  {% else %}
  {{ form.amount(placeholder="amount") }}
  {% endif %}
  <span class="error">
    {% if form.amount.errors %}
    {% for error in form.amount.errors %}
    {{ error }}
    {% endfor %}
    {% endif %}
  </span>
</p>



{% if change2 %} 
<button class="btn btn-sm btn-success" type="submit">Update!</button>
</form>
<br>
<br> 
<form method="post" action="/deleteaccount">
  <input class="btn btn-sm btn-danger" type="submit" value="Remove my account!" onclick="return confirm('Press OK to remove your account. This can not be undone!')">
</form>
<br>   
<p><a href="/">Back</a></p>
{% else %}
{% if change %}
<button class="btn btn-sm btn-primary" type="submit" id="submit">Update invoice!</button>
{% else %}
<button class="btn btn-sm btn-primary" type="submit" id="submit">Claim!</button>
{% endif %}
{% if embedded %}
{% if change %}
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>

<script>
  $("#form_inv").submit(function(e) {
    e.preventDefault();
    url= "/invoice/change"+"{{invoice.invoiceid|safe}}"
    $.post(url,
      $("#form_inv").serialize(),
      function( data ) {
        $('#invoice_quick').html( data );

      }

      );
  });

</script>

{% else %}

<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>

<script>
  $("#form_inv").submit(function(e) {
    e.preventDefault();
    $.post("/invoice/create-emb=True",
      $("#form_inv").serialize(),
      function( data ) {
        $('#invoice_quick').html( data );

      }

      );
  });

</script>
{% endif %}
{% endif %}
</form>
{% endif %}



{% endblock %}